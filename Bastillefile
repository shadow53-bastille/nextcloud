# Install the dependencies for Nextcloud
# MariaDB is also required in a different container
PKG php80 php80-pecl-APCu php80-bcmath php80-bz2 php80-ctype php80-curl php80-dom php80-fileinfo php80-filter
PKG php80-gd php80-gmp php80-iconv php80-mbstring php80-pcntl php80-pdo php80-posix php80-session
PKG php80-simplexml php80-xml php80-xmlreader php80-xmlwriter php80-xsl php80-zip php80-zlib php80-exif
PKG php80-intl php80-ldap php80-pdo_mysql php80-opcache php80-openssl php80-smbclient php80-imap 
# Add mariadb client for backup purposes
PKG mariadb105-client

# Install the install/update script
CP usr .

# Mount nextcloud install dir so nginx can access files
MOUNT /usr/local/nextcloud usr/local/nextcloud/root nullfs rw 0 0

# Install nextcloud from archive
CMD /usr/local/bin/install-nextcloud install

SYSRC php_fpm_enable=YES
SERVICE php_fpm start
